<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>La Casa de Green ✅️</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background-color: #f4f4f4;
      padding: 15px;
      max-width: 100%;
      margin: 0 auto;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #444;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    .section {
      border: 1px solid #e0e0e0;
      padding: 15px;
      margin-top: 15px;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .section h2 {
      color: #333;
      margin-bottom: 10px;
      border-bottom: 2px solid #4CAF50;
      padding-bottom: 5px;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      margin-top: 15px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #45a049;
    }
    button.clear {
      background-color: #f44336;
      margin-top: 20px;
    }
    .results {
      margin-top: 10px;
      background: #f1f1f1;
      padding: 15px;
      border-radius: 5px;
    }
    .results p {
      margin-bottom: 5px;
    }
    #mensagemErro {
      color: red;
      font-weight: bold;
      text-align: center;
      margin-top: 10px;
    }
    .footer {
      margin-top: 30px;
      text-align: center;
      font-weight: bold;
      color: #666;
    }
    .badge {
      font-size: 10px;
      color: #999;
      margin-left: 10px;
    }
    .inputWithSelect {
      display: inline-flex;
      align-items: center;
      border: 1px solid #ddd;
      border-radius: 4px;
      overflow: hidden;
      width: 100%;
      margin-bottom: 10px;
    }
    .inputWithSelect input {
      border: none;
      outline: none;
      padding: 10px;
      width: 60%;
      font-size: 16px;
    }
    .inputWithSelect select {
      border: none;
      padding: 10px;
      border-left: 1px solid #ddd;
      background: #fff;
      font-size: 16px;
      width: 40%;
    }
    .hidden {
      display: none;
    }
    /* Estilo para os Extras */
    .extraOutcome {
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      background-color: #e8e8e8;
    }
    .remove-extra-btn {
      background-color: #d32f2f;
      color: #fff;
      border: none;
      padding: 5px 10px;
      border-radius: 3px;
      margin-top: 5px;
      cursor: pointer;
    }
    .remove-extra-btn:hover {
      background-color: #b71c1c;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>La Casa de Green ✅️</h1>

    <label for="modoSelect">Selecione o Modo:</label>
    <select id="modoSelect" onchange="alternarModo()">
      <option value="aumentoSimples">Aumento Simples (3 Back Bets)</option>
      <option value="parOuImpar">Par ou Ímpar (2 Back Bets)</option>
      <option value="backLay">Back & Lay</option>
      <option value="aumentoComLay">Aumento com Lay</option>
    </select>

    <!-- Aumento Simples -->
    <div id="aumentoSimples" class="section">
      <h2>Aumento Simples</h2>
      
      <!-- Campos Principais: Casa -->
      <label for="oddBack1">Odd Casa (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddBack1" step="0.01" placeholder="Ex: 2.00">
        <select id="aumentoOdd1">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOdd1" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      
      <!-- Opção de Comissão para Casa -->
      <label>
        <input type="checkbox" id="toggleComissaoCasa" onchange="toggleComissaoCasa()"> Usar Comissão para Casa
      </label>
      <div id="comissaoCasaContainer" class="inputWithSelect" style="display:none;">
        <select id="comissaoOddCasa">
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">Personalizada</option>
        </select>
        <input type="number" id="customInputComissaoOddCasa" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      </div>

      <!-- Campos Principais: Empate -->
      <label for="oddBack2">Odd Empate (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddBack2" step="0.01" placeholder="Ex: 3.00">
        <select id="aumentoOdd2">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOdd2" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      
      <!-- Opção de Comissão para Empate -->
      <label>
        <input type="checkbox" id="toggleComissaoEmpate" onchange="toggleComissaoEmpate()"> Usar Comissão para Empate
      </label>
      <div id="comissaoEmpateContainer" class="inputWithSelect" style="display:none;">
        <select id="comissaoOddEmpate">
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">Personalizada</option>
        </select>
        <input type="number" id="customInputComissaoOddEmpate" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      </div>

      <!-- Campos Principais: Fora -->
      <label for="oddBack3">Odd Fora (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddBack3" step="0.01" placeholder="Ex: 4.00">
        <select id="aumentoOdd3">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOdd3" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      
      <!-- Opção de Comissão para Fora -->
      <label>
        <input type="checkbox" id="toggleComissaoFora" onchange="toggleComissaoFora()"> Usar Comissão para Fora
      </label>
      <div id="comissaoForaContainer" class="inputWithSelect" style="display:none;">
        <select id="comissaoOddFora">
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">Personalizada</option>
        </select>
        <input type="number" id="customInputComissaoOddFora" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      </div>

      <label for="principal">Selecione a aposta principal:</label>
      <select id="principal">
        <option value="1">Aposta Casa</option>
        <option value="2">Aposta Empate</option>
        <option value="3">Aposta Fora</option>
      </select>

      <label for="stakePrincipal">Aposta para o Resultado principal (R$):</label>
      <input type="number" id="stakePrincipal" step="0.01" placeholder="Ex: 53.00">

      <!-- Botão para adicionar Extras (Modo Aumento Simples) -->
      <button type="button" onclick="adicionarExtra()">Adicionar Extra</button>
      <!-- Container exclusivo para Extras no Aumento Simples -->
      <div id="extrasContainerSimples"></div>

      <button onclick="calcularAumentoSimples()">Calcular</button>

      <div class="results">
        <p><strong>Aposta Casa:</strong> R$ <span id="stakeResultado1"></span></p>
        <p><strong>Aposta Empate:</strong> R$ <span id="stakeResultado2"></span></p>
        <p><strong>Aposta Fora:</strong> R$ <span id="stakeResultado3"></span></p>
        <div id="extraResultsContainerSimples" style="display:none;">
          <div id="extraResultsSimples"></div>
        </div>
        <p><strong>Lucro (independente do resultado):</strong> R$ <span id="lucroAumentoSimples"></span></p>
      </div>
    </div>

    <!-- Par ou Ímpar -->
    <div id="parOuImpar" class="section hidden">
      <h2>Par ou Ímpar</h2>
      <label for="oddPar">Odd Par (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddPar" step="0.01" placeholder="Ex: 1.80">
        <select id="aumentoOddPar">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddPar" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      
      <!-- Opção de Comissão para Par -->
      <label>
        <input type="checkbox" id="toggleComissaoPar" onchange="toggleComissaoPar()"> Usar Comissão para Par
      </label>
      <div id="comissaoParContainer" class="inputWithSelect" style="display:none;">
        <select id="comissaoOddPar">
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">Personalizada</option>
        </select>
        <input type="number" id="customInputComissaoOddPar" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      </div>

      <label for="oddImpar">Odd Ímpar (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddImpar" step="0.01" placeholder="Ex: 1.80">
        <select id="aumentoOddImpar">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddImpar" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      <label for="stakePar">Aposta no Par (R$):</label>
      <input type="number" id="stakePar" step="0.01" placeholder="Ex: 20.00">
      <button onclick="calcularParOuImpar()">Calcular</button>
      <div class="results">
        <p><strong>Aposta no Ímpar:</strong> R$ <span id="stakeImpar"></span></p>
        <p><strong>Lucro/Retorno:</strong> R$ <span id="lucroParOuImpar"></span></p>
      </div>
    </div>

    <!-- Back & Lay -->
    <div id="backLay" class="section hidden">
      <h2>Back & Lay</h2>
      <label for="oddBack">Odd Back (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddBack" step="0.01" placeholder="Ex: 2.00">
        <select id="aumentoOddBack">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddBack" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      <label for="oddLay">Odd Lay:</label>
      <input type="number" id="oddLay" step="0.01" placeholder="Ex: 2.00">
      <label for="stakeBack">Aposta no Back (R$):</label>
      <input type="number" id="stakeBack" step="0.01" placeholder="Ex: 10.00">
      <label for="comissaoLay">Comissão no Lay (%):</label>
      <div class="inputWithSelect">
        <select id="comissaoLay">
          <option value="0">0% (Sem Taxa)</option>
          <option value="2.8">2,8%</option>
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputComissaoLay" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      <button onclick="calcularBackLay()">Calcular</button>
      <div class="results">
        <p><strong>Aposta Sugerida no Lay:</strong> R$ <span id="stakeLay"></span></p>
        <p><strong>Responsabilidade (Lay):</strong> R$ <span id="responsabilidadeLay"></span></p>
        <p><strong>Lucro se o Back vencer:</strong> R$ <span id="lucroSeBackVencer"></span></p>
        <p><strong>Lucro se o Lay vencer:</strong> R$ <span id="lucroSeLayVencer"></span></p>
      </div>
    </div>

    <!-- Aumento com Lay -->
    <div id="aumentoComLay" class="section hidden">
      <h2>Aumento com Lay</h2>
      <label for="oddCasaLay">Odd Casa (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddCasaLay" step="0.01" placeholder="Ex: 2.00">
        <select id="aumentoOddCasaLay">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddCasaLay" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      <label for="oddEmpateLay">Odd Empate (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddEmpateLay" step="0.01" placeholder="Ex: 3.00">
        <select id="aumentoOddEmpateLay">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddEmpateLay" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      <label for="oddForaLay">Odd Fora (Original) + Aumento:</label>
      <div class="inputWithSelect">
        <input type="number" id="oddForaLay" step="0.01" placeholder="Ex: 4.00">
        <select id="aumentoOddForaLay">
          <option value="0">Sem aumento (0%)</option>
          <option value="25">25%</option>
          <option value="30">30%</option>
          <option value="50">50%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputOddForaLay" step="0.01" placeholder="Digite o valor personalizado (%)" style="display:none;">
      <label for="oddLayAumento">Odd Lay:</label>
      <input type="number" id="oddLayAumento" step="0.01" placeholder="Ex: 4.60">
      <label for="comissaoLayAumento">Comissão Lay (%):</label>
      <div class="inputWithSelect">
        <select id="comissaoLayAumento">
          <option value="0">0% (Sem Taxa)</option>
          <option value="2.8">2,8%</option>
          <option value="4.5">4,5%</option>
          <option value="6.5">6,5%</option>
          <option value="custom">% Personalizada</option>
        </select>
      </div>
      <input type="number" id="customInputComissaoLayAumento" step="0.01" placeholder="Digite a comissão personalizada (%)" style="display:none;">
      <label for="stakePrincipalLay">Stake Principal (R$):</label>
      <input type="number" id="stakePrincipalLay" step="0.01" placeholder="Ex: 50.00">
      
      <!-- Botão para adicionar Extras no Modo Aumento com Lay -->
      <button type="button" onclick="adicionarExtraLay()">Adicionar Extra</button>
      <!-- Container exclusivo para Extras no Aumento com Lay -->
      <div id="extrasContainerLay"></div>
      
      <button onclick="calcularAumentoComLay()">Calcular</button>
      <div class="results">
        <p><strong>Aposta Casa:</strong> R$ <span id="stakeCasaLay"></span></p>
        <p><strong>Aposta Empate:</strong> R$ <span id="stakeEmpateLay"></span></p>
        <p><strong>Aposta Fora:</strong> R$ <span id="stakeForaLay"></span></p>
        <p><strong>Aposta Lay:</strong> R$ <span id="stakeLayAumento"></span> (Responsabilidade: R$ <span id="responsabilidadeLayAumento"></span>)</p>
        <div id="extraResultsContainerLay" style="display:none;">
          <div id="extraResultsLay"></div>
        </div>
        <p><strong>Lucro (independente do resultado):</strong> R$ <span id="lucroFinalLay"></span></p>
      </div>
    </div>

    <p id="mensagemErro"></p>
    <button onclick="limparCampos()" class="clear">Limpar Todos os Campos</button>
    <div class="footer">La Casa de Green ✅️ <span class="badge">By Negueta</span></div>
  </div>

  <script>
    // Variáveis globais para Extras em Aumento Simples e Aumento com Lay
    let nextExtraId = 1;
    let activeExtrasSimples = [];
    let activeExtrasLay = [];

    function alternarModo() {
      ['aumentoSimples', 'parOuImpar', 'backLay', 'aumentoComLay'].forEach(mode => {
        document.getElementById(mode).classList.add('hidden');
      });
      document.getElementById(document.getElementById('modoSelect').value).classList.remove('hidden');
      document.getElementById('mensagemErro').innerText = '';
    }

    function toggleCustomInput(selectElement, inputId) {
      const customInput = document.getElementById(inputId);
      customInput.style.display = selectElement.value === "custom" ? "block" : "none";
    }

    function getNumero(id) {
      const elemento = document.getElementById(id);
      if (!elemento || elemento.value === "") return 0;
      if (elemento.tagName === "SELECT" && elemento.value === "custom") {
        const customInputId = id.replace("aumento", "customInput").replace("comissao", "customInputComissao");
        return parseFloat(document.getElementById(customInputId).value) || 0;
      }
      return parseFloat(elemento.value);
    }

    function aplicarAumentoOdd(oddOriginal, percentual) {
      return (oddOriginal - 1) * (1 + percentual / 100) + 1;
    }

    // Funções para Comissão no Modo Aumento Simples
    function toggleComissaoCasa() {
      const checkbox = document.getElementById('toggleComissaoCasa');
      const comissaoContainer = document.getElementById('comissaoCasaContainer');
      const aumentoSelect = document.getElementById('aumentoOdd1');
      const customAumento = document.getElementById('customInputOdd1');
      if (checkbox.checked) {
        comissaoContainer.style.display = 'inline-flex';
        aumentoSelect.style.display = 'none';
        customAumento.style.display = 'none';
      } else {
        comissaoContainer.style.display = 'none';
        aumentoSelect.style.display = 'block';
      }
    }
    function toggleComissaoEmpate() {
      const checkbox = document.getElementById('toggleComissaoEmpate');
      const comissaoContainer = document.getElementById('comissaoEmpateContainer');
      const aumentoSelect = document.getElementById('aumentoOdd2');
      const customAumento = document.getElementById('customInputOdd2');
      if (checkbox.checked) {
        comissaoContainer.style.display = 'inline-flex';
        aumentoSelect.style.display = 'none';
        customAumento.style.display = 'none';
      } else {
        comissaoContainer.style.display = 'none';
        aumentoSelect.style.display = 'block';
      }
    }
    function toggleComissaoFora() {
      const checkbox = document.getElementById('toggleComissaoFora');
      const comissaoContainer = document.getElementById('comissaoForaContainer');
      const aumentoSelect = document.getElementById('aumentoOdd3');
      const customAumento = document.getElementById('customInputOdd3');
      if (checkbox.checked) {
        comissaoContainer.style.display = 'inline-flex';
        aumentoSelect.style.display = 'none';
        customAumento.style.display = 'none';
      } else {
        comissaoContainer.style.display = 'none';
        aumentoSelect.style.display = 'block';
      }
    }

    // Função para Comissão no Modo Par ou Ímpar
    function toggleComissaoPar() {
      const checkbox = document.getElementById('toggleComissaoPar');
      const comissaoContainer = document.getElementById('comissaoParContainer');
      const aumentoSelect = document.getElementById('aumentoOddPar');
      const customAumento = document.getElementById('customInputOddPar');
      if (checkbox.checked) {
        comissaoContainer.style.display = 'inline-flex';
        aumentoSelect.style.display = 'none';
        customAumento.style.display = 'none';
      } else {
        comissaoContainer.style.display = 'none';
        aumentoSelect.style.display = 'block';
      }
    }

    // Função para adicionar um Extra no modo Aumento Simples
    function adicionarExtra() {
      // Extras para Aumento Simples
      if (document.getElementById('aumentoSimples').classList.contains('hidden')) return; // Não adicionar aqui
      if (activeExtrasSimples.length >= 5) {
        alert("Você já adicionou o máximo de 5 extras.");
        return;
      }
      const extraId = nextExtraId++;
      activeExtrasSimples.push(extraId);
      const container = document.getElementById("extrasContainerSimples");
      const div = document.createElement("div");
      div.className = "extraOutcome";
      div.id = "extraContainerSimples" + extraId;
      div.innerHTML = `
        <label>Extra ${extraId} - Odd:</label>
        <input type="number" id="extraOdd${extraId}" step="0.01" placeholder="Ex: 2.50">
        <button type="button" class="remove-extra-btn" onclick="removerExtraSimples(${extraId})">Remover Extra ${extraId}</button>
      `;
      container.appendChild(div);
    }
    function removerExtraSimples(extraId) {
      activeExtrasSimples = activeExtrasSimples.filter(id => id !== extraId);
      const div = document.getElementById("extraContainerSimples" + extraId);
      if (div) div.remove();
    }

    // Função para adicionar um Extra no modo Aumento com Lay
    function adicionarExtraLay() {
      // Extras para Aumento com Lay
      if (document.getElementById('aumentoComLay').classList.contains('hidden')) return;
      if (activeExtrasLay.length >= 5) {
        alert("Você já adicionou o máximo de 5 extras.");
        return;
      }
      const extraId = nextExtraId++;
      activeExtrasLay.push(extraId);
      const container = document.getElementById("extrasContainerLay");
      const div = document.createElement("div");
      div.className = "extraOutcome";
      div.id = "extraContainerLay" + extraId;
      div.innerHTML = `
        <label>Extra ${extraId} - Odd:</label>
        <input type="number" id="extraOdd${extraId}" step="0.01" placeholder="Ex: 2.50">
        <button type="button" class="remove-extra-btn" onclick="removerExtraLay(${extraId})">Remover Extra ${extraId}</button>
      `;
      container.appendChild(div);
    }
    function removerExtraLay(extraId) {
      activeExtrasLay = activeExtrasLay.filter(id => id !== extraId);
      const div = document.getElementById("extraContainerLay" + extraId);
      if (div) div.remove();
    }

    // Aumento Simples – cálculo com Extras
    function calcularAumentoSimples() {
      // Para os 3 mercados principais
      let oddCasa;
      if (document.getElementById('toggleComissaoCasa').checked) {
        const comissao = getNumero('comissaoOddCasa');
        oddCasa = (getNumero('oddBack1') - 1) * (1 - comissao / 100) + 1;
      } else {
        oddCasa = aplicarAumentoOdd(getNumero('oddBack1'), getNumero('aumentoOdd1'));
      }
      let oddEmpate;
      if (document.getElementById('toggleComissaoEmpate').checked) {
        const comissao = getNumero('comissaoOddEmpate');
        oddEmpate = (getNumero('oddBack2') - 1) * (1 - comissao / 100) + 1;
      } else {
        oddEmpate = aplicarAumentoOdd(getNumero('oddBack2'), getNumero('aumentoOdd2'));
      }
      let oddFora;
      if (document.getElementById('toggleComissaoFora').checked) {
        const comissao = getNumero('comissaoOddFora');
        oddFora = (getNumero('oddBack3') - 1) * (1 - comissao / 100) + 1;
      } else {
        oddFora = aplicarAumentoOdd(getNumero('oddBack3'), getNumero('aumentoOdd3'));
      }
      
      const odds = [oddCasa, oddEmpate, oddFora];
      const principal = parseInt(document.getElementById('principal').value);
      const stakePrincipal = getNumero('stakePrincipal');
      const stakes = [];
      
      odds.forEach((odd, i) => {
        if (i + 1 === principal) {
          stakes[i] = stakePrincipal;
        } else {
          stakes[i] = stakePrincipal * odds[principal - 1] / odd;
        }
      });
      // O retorno alvo é o retorno da aposta principal
      const retornoAlvo = stakePrincipal * odds[principal - 1];
      
      // Calcular stakes ideais para os 3 mercados
      const stakesIdeais = [
        retornoAlvo / oddCasa,
        retornoAlvo / oddEmpate,
        retornoAlvo / oddFora
      ];
      
      const totalStakesIdeais = stakesIdeais.reduce((a, b) => a + b, 0);
      const lucroBase = retornoAlvo - totalStakesIdeais;
      
      // Extras no modo Aumento Simples
      let extrasTotalInvestido = 0;
      let extrasHtml = "";
      activeExtrasSimples.forEach(id => {
        const oddExtra = getNumero("extraOdd" + id);
        if (oddExtra > 0) {
          const stakeExtra = retornoAlvo / oddExtra;
          extrasTotalInvestido += stakeExtra;
          extrasHtml += `<p><strong>Extra ${id}:</strong> Odd: ${oddExtra.toFixed(2)} | Stake: ${stakeExtra.toFixed(2)}</p>`;
        }
      });
      if (activeExtrasSimples.length > 0) {
        document.getElementById("extraResultsContainerSimples").style.display = "block";
        document.getElementById("extraResultsSimples").innerHTML = extrasHtml;
      } else {
        document.getElementById("extraResultsContainerSimples").style.display = "none";
      }
      
      const stakesReais = [
        (getNumero('aumentoOdd1') > 0 || document.getElementById('toggleComissaoCasa').checked ? stakePrincipal : stakesIdeais[0]),
        (getNumero('aumentoOdd2') > 0 || document.getElementById('toggleComissaoEmpate').checked ? stakePrincipal : stakesIdeais[1]),
        (getNumero('aumentoOdd3') > 0 || document.getElementById('toggleComissaoFora').checked ? stakePrincipal : stakesIdeais[2])
      ];
      
      const totalInvestidoPrincipais = stakesReais.reduce((a, b) => a + b, 0);
      const totalInvestido = totalInvestidoPrincipais + extrasTotalInvestido;
      
      const lucroFinal = retornoAlvo - totalInvestido;
      
      document.getElementById('stakeResultado1').textContent = stakesReais[0].toFixed(2);
      document.getElementById('stakeResultado2').textContent = stakesReais[1].toFixed(2);
      document.getElementById('stakeResultado3').textContent = stakesReais[2].toFixed(2);
      document.getElementById('lucroAumentoSimples').textContent = lucroFinal.toFixed(2);
    }

    // Par ou Ímpar
    function calcularParOuImpar() {
      let oddPar;
      if (document.getElementById('toggleComissaoPar').checked) {
        const comissao = getNumero('comissaoOddPar');
        oddPar = (getNumero('oddPar') - 1) * (1 - comissao / 100) + 1;
      } else {
        oddPar = aplicarAumentoOdd(getNumero('oddPar'), getNumero('aumentoOddPar'));
      }
      const oddImpar = aplicarAumentoOdd(getNumero('oddImpar'), getNumero('aumentoOddImpar'));
      const stakePar = getNumero('stakePar');
      const stakeImpar = (stakePar * oddPar) / oddImpar;
      const lucro = stakePar * (oddPar - 1) - stakeImpar;

      document.getElementById('stakeImpar').textContent = stakeImpar.toFixed(2);
      document.getElementById('lucroParOuImpar').textContent = lucro.toFixed(2);
    }

    // Back & Lay
    function calcularBackLay() {
      const oddBack = aplicarAumentoOdd(getNumero('oddBack'), getNumero('aumentoOddBack'));
      const oddLay = getNumero('oddLay');
      const stakeBack = getNumero('stakeBack');
      const comissao = getNumero('comissaoLay') / 100;
      const stakeLay = (stakeBack * oddBack) / (oddLay - comissao);
      const responsabilidade = stakeLay * (oddLay - 1);
      const lucroBack = stakeBack * (oddBack - 1) - responsabilidade;
      const lucroLay = stakeLay * (1 - comissao) - stakeBack;

      document.getElementById('stakeLay').textContent = stakeLay.toFixed(2);
      document.getElementById('responsabilidadeLay').textContent = responsabilidade.toFixed(2);
      document.getElementById('lucroSeBackVencer').textContent = lucroBack.toFixed(2);
      document.getElementById('lucroSeLayVencer').textContent = lucroLay.toFixed(2);
    }

    // Aumento com Lay – cálculo atualizado para lucroFinal = lucroBase + lucroLay
    function calcularAumentoComLay() {
      const oddCasaOriginal = getNumero('oddCasaLay');
      const aumentoCasa = getNumero('aumentoOddCasaLay');
      const oddEmpateOriginal = getNumero('oddEmpateLay');
      const aumentoEmpate = getNumero('aumentoOddEmpateLay');
      const oddForaOriginal = getNumero('oddForaLay');
      const aumentoFora = getNumero('aumentoOddForaLay');
      const oddLay = getNumero('oddLayAumento');
      const comissaoLay = getNumero('comissaoLayAumento') / 100;
      const stakePrincipal = getNumero('stakePrincipalLay');

      if (!oddCasaOriginal || !oddEmpateOriginal || !oddForaOriginal || !oddLay || !stakePrincipal) {
        document.getElementById('mensagemErro').innerText = 'Preencha todos os campos obrigatórios.';
        return;
      }

      // Calcular odd final para cada mercado (aplicando comissão se ativada)
      const oddCasa = aumentoCasa > 0 ? aplicarAumentoOdd(oddCasaOriginal, aumentoCasa) : oddCasaOriginal;
      const oddEmpate = aumentoEmpate > 0 ? aplicarAumentoOdd(oddEmpateOriginal, aumentoEmpate) : oddEmpateOriginal;
      const oddFora = aumentoFora > 0 ? aplicarAumentoOdd(oddForaOriginal, aumentoFora) : oddForaOriginal;

      // Para os mercados com aumento, a stake aplicada é a stake principal integral.
      const retornoCasa = (aumentoCasa > 0 ? stakePrincipal * oddCasa : Infinity);
      const retornoEmpate = (aumentoEmpate > 0 ? stakePrincipal * oddEmpate : Infinity);
      const retornoFora = (aumentoFora > 0 ? stakePrincipal * oddFora : Infinity);

      // Retorno alvo é o menor retorno entre os mercados com aumento
      const retornos = [retornoCasa, retornoEmpate, retornoFora].filter(r => r !== Infinity);
      const retornoAlvo = Math.min(...retornos);

      // Calcular a stake ideal para cada mercado para atingir exatamente o retornoAlvo.
      const stakesIdeais = [
        retornoAlvo / oddCasa,
        retornoAlvo / oddEmpate,
        retornoAlvo / oddFora
      ];

      // Lucro base (das apostas principais) = retornoAlvo - (soma das stakes ideais)
      const somaStakesIdeais = stakesIdeais.reduce((a, b) => a + b, 0);
      const lucroBase = retornoAlvo - somaStakesIdeais;

      // Para os mercados com aumento, a stake real aplicada é a stake principal.
      // Excedente = stakePrincipal - stakeIdeal (por mercado)
      const excedentes = [
        (aumentoCasa > 0 ? stakePrincipal - stakesIdeais[0] : 0),
        (aumentoEmpate > 0 ? stakePrincipal - stakesIdeais[1] : 0),
        (aumentoFora > 0 ? stakePrincipal - stakesIdeais[2] : 0)
      ];

      // Converter cada excedente em aposta Lay usando:
      // stakeLay_i = (excedente_i * oddFinal_i) / (oddLay - comissaoLay)
      const oddsArray = [oddCasa, oddEmpate, oddFora];
      const stakesLayArray = excedentes.map((excedente, i) =>
        excedente > 0 ? (excedente * oddsArray[i]) / (oddLay - comissaoLay) : 0
      );
      const totalStakeLay = stakesLayArray.reduce((a, b) => a + b, 0);

      // Responsabilidade total do Lay:
      const responsabilidades = stakesLayArray.map(stake => stake * (oddLay - 1));
      const totalResponsibility = responsabilidades.reduce((a, b) => a + b, 0);

      // Calcular o lucro da operação Lay para cada mercado:
      // lucroLay_i = (excedente_i * (oddFinal_i - 1)) - (stakeLay_i * (oddLay - 1))
      const profitLayArray = excedentes.map((excedente, i) => {
        if (excedente > 0) {
          const stakeLay_i = (excedente * oddsArray[i]) / (oddLay - comissaoLay);
          const responsabilidade_i = stakeLay_i * (oddLay - 1);
          return (excedente * (oddsArray[i] - 1)) - responsabilidade_i;
        }
        return 0;
      });
      const lucroLay = profitLayArray.reduce((a, b) => a + b, 0);

      // O lucro final garantido é a soma do lucro base com o lucro da operação Lay.
      const finalProfit = lucroBase + lucroLay;

      // Extras: para cada extra, a stake ideal é calculada da mesma forma que uma aposta sem aumento.
      let extrasTotalInvestido = 0;
      let extrasHtml = "";
      activeExtrasLay.forEach(id => {
        const oddExtra = getNumero("extraOdd" + id);
        if (oddExtra > 0) {
          const stakeExtra = retornoAlvo / oddExtra;
          extrasTotalInvestido += stakeExtra;
          extrasHtml += `<p><strong>Extra ${id}:</strong> Odd: ${oddExtra.toFixed(2)} | Stake: ${stakeExtra.toFixed(2)}</p>`;
        }
      });
      if (activeExtrasLay.length > 0) {
        document.getElementById("extraResultsContainerLay").style.display = "block";
        document.getElementById("extraResultsLay").innerHTML = extrasHtml;
      } else {
        document.getElementById("extraResultsContainerLay").style.display = "none";
      }

      // Total investido nos mercados principais
      const stakesReais = [
        (aumentoCasa > 0 ? stakePrincipal : stakesIdeais[0]),
        (aumentoEmpate > 0 ? stakePrincipal : stakesIdeais[1]),
        (aumentoFora > 0 ? stakePrincipal : stakesIdeais[2])
      ];
      const totalInvestidoPrincipais = stakesReais.reduce((a, b) => a + b, 0);
      // Total investido geral inclui os extras
      const totalInvestido = totalInvestidoPrincipais + extrasTotalInvestido;

      // Para este modo, o lucro final garantido é a soma do lucro base com o lucro da operação Lay.
      const finalCalculatedProfit = finalProfit; 

      document.getElementById('stakeCasaLay').textContent = aumentoCasa > 0 ? stakePrincipal.toFixed(2) : stakesIdeais[0].toFixed(2);
      document.getElementById('stakeEmpateLay').textContent = aumentoEmpate > 0 ? stakePrincipal.toFixed(2) : stakesIdeais[1].toFixed(2);
      document.getElementById('stakeForaLay').textContent = aumentoFora > 0 ? stakePrincipal.toFixed(2) : stakesIdeais[2].toFixed(2);
      document.getElementById('stakeLayAumento').textContent = totalStakeLay.toFixed(2);
      document.getElementById('responsabilidadeLayAumento').textContent = totalResponsibility.toFixed(2);
      document.getElementById('lucroFinalLay').textContent = finalCalculatedProfit.toFixed(2);
      document.getElementById('mensagemErro').innerText = '';
    }

    function limparCampos() {
      document.querySelectorAll("input").forEach(input => input.value = "");
      document.querySelectorAll(".results span").forEach(span => span.textContent = "");
      document.getElementById('mensagemErro').innerText = '';
      document.querySelectorAll("input[id^='customInput']").forEach(input => input.style.display = "none");
      // Limpar extras de ambos os modos
      document.getElementById("extrasContainerSimples").innerHTML = "";
      document.getElementById("extrasContainerLay").innerHTML = "";
      document.getElementById("extraResultsContainerSimples").style.display = "none";
      document.getElementById("extraResultsContainerLay").style.display = "none";
      activeExtrasSimples = [];
      activeExtrasLay = [];
      nextExtraId = 1;
    }

    document.addEventListener('DOMContentLoaded', alternarModo);
  </script>
</body>
</html>
